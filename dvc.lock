schema: '2.0'
stages:
  ingest:
    cmd: python src/data/ingest.py
    deps:
    - path: data/raw/crop_yield.csv
      hash: md5
      md5: cefa48c7486bbc1fa4f2f65f4e1ef342
      size: 1620945
    - path: src/data/ingest.py
      hash: md5
      md5: 7d3fd5783b5416cf32dde3ff95f7adad
      size: 1603
    params:
      params.yaml:
        data.raw_file: data/raw/crop_yield.csv
    outs:
    - path: data/interim/cleaned_data.csv
      hash: md5
      md5: f1e993a7524392f3cb9123bb24963948
      size: 1582745
  preprocess:
    cmd: python src/features/preprocess.py
    deps:
    - path: data/interim/cleaned_data.csv
      hash: md5
      md5: f1e993a7524392f3cb9123bb24963948
      size: 1582745
    - path: src/features/preprocess.py
      hash: md5
      md5: 7d9272a0c335428cba658b5cc605b9c8
      size: 6469
    params:
      params.yaml:
        base.random_state: 42
        base.test_size: 0.2
        data.drop_cols:
        - Area
        - Production
        - Crop_Year
    outs:
    - path: data/processed/columns.pkl
      hash: md5
      md5: 0ccf10626aadb5ce8f17b55e577a9374
      size: 1576
    - path: data/processed/preprocessor.pkl
      hash: md5
      md5: 1f34e5e0d8f94368cbc8db8f48b68155
      size: 5169
    - path: data/processed/test.csv
      hash: md5
      md5: 28d4a206ef9d3a79422cd17f67ad2aa0
      size: 7351031
    - path: data/processed/train.csv
      hash: md5
      md5: 0404644b9d858e0bb6a40564f06523ba
      size: 29395525
  train:
    cmd: python src/models/train_model.py
    deps:
    - path: data/processed/train.csv
      hash: md5
      md5: 0404644b9d858e0bb6a40564f06523ba
      size: 29395525
    - path: src/models/train_model.py
      hash: md5
      md5: d49493829b87c91f55b0ce48fe1ec5b9
      size: 2450
    params:
      params.yaml:
        train.max_depth: 3
        train.model_type: gradient_boosting
        train.n_estimators: 100
    outs:
    - path: models/model.pkl
      hash: md5
      md5: ff6c1804f7f5ba3157ba665d96da98aa
      size: 139013
  test_data:
    cmd: pytest src/data/test_data.py
    deps:
    - path: data/raw/crop_yield.csv
      hash: md5
      md5: cefa48c7486bbc1fa4f2f65f4e1ef342
      size: 1620945
    - path: src/data/test_data.py
      hash: md5
      md5: db6619e08e7ede3f2937cf6fe9b81fd2
      size: 1007
  evaluate:
    cmd: python src/models/evaluate_model.py
    deps:
    - path: data/processed/test.csv
      hash: md5
      md5: 28d4a206ef9d3a79422cd17f67ad2aa0
      size: 7351031
    - path: models/model.pkl
      hash: md5
      md5: ff6c1804f7f5ba3157ba665d96da98aa
      size: 139013
    - path: src/models/evaluate_model.py
      hash: md5
      md5: e054391527a50d804a4fd82137bbfeca
      size: 1550
    outs:
    - path: metrics.json
      hash: md5
      md5: 0a37562427e4c9d214d1598c9cb6c2c4
      size: 73
  analyze:
    cmd: python src/visualization/analyze.py
    deps:
    - path: data/interim/cleaned_data.csv
      hash: md5
      md5: f1e993a7524392f3cb9123bb24963948
      size: 1582745
    - path: src/visualization/analyze.py
      hash: md5
      md5: 78549ebadf232e54ddb0b9d6fb65350d
      size: 5501
    outs:
    - path: reports/eda_summary.txt
      hash: md5
      md5: 1cc49702cadcd0a649432a8a2c17af83
      size: 6510
    - path: reports/figures/
      hash: md5
      md5: 2fbc68a3d3da28f3154a7a99ec122a92.dir
      size: 835687
      nfiles: 19
  train_evaluate:
    cmd: python src/models/train_evaluate.py
    deps:
    - path: data/processed/test.csv
      hash: md5
      md5: 28d4a206ef9d3a79422cd17f67ad2aa0
      size: 7351031
    - path: data/processed/train.csv
      hash: md5
      md5: 0404644b9d858e0bb6a40564f06523ba
      size: 29395525
    - path: src/models/train_evaluate.py
      hash: md5
      md5: b50dd5e68cbe28fd714a40cae022f76a
      size: 6592
    outs:
    - path: models/best_model.pkl
      hash: md5
      md5: be6b524550bc58ac2a3530de8f3240e2
      size: 139157
    - path: reports/model_comparison.csv
      hash: md5
      md5: 55ff96cd719cfd2f6c0a8149bd8105ed
      size: 1352
